\subsubsubsection{Reactive entities}
This is one of the largest packages of our system: it contains all the types of
reactive entities (streets, lanes, stretches, etc.) as well as their builders
and factories, the district class (which acts more or less as a controller for
the system), the entity registries and directories (subdivided by entity types),
and finally some scaffolding like Utils packages.

Here the most important interfaces are \texttt{Infrastructure} and
\texttt{Treadable}. The former represents an infrastructural object while the
latter represents a piece of infrastructure on which an agent can travel
(i.e. stretches and intersections).
In our system we will think the streets and lanes just as containers
which use the
\textit{Composite} pattern: a \texttt{Street} is a composition of \texttt{Way}s,
which in turn are composed of \texttt{Lane}s, which finally are composed of
\texttt{Stretch}es.
Thus, we consider the stretch as the basic unit
for streets where a agent can travel.
Handling the concurrency at this level potentially enables
an high level of  parallelism in our system.

The other infrastructural entity on which an agent can travel is
\texttt{Intersection}. Each \texttt{Intersection} reserves one of its
entries for a traveler if it is a vehicle, otherwise it is just bypassed by
pedestrians and bicycles.

\texttt{Treadable} objects do not make worker threads block in critical regions:
each
time a traveler moves on them, a \texttt{Treadable} object attempt to make it
enter. If this
operation is successful, travelers advance in the next piece of infrastructure
and leave the former one, otherwise they are rescheduled for a little time ahead
to retry the operation (without leaving the reactive entity they are currently
in).

In this package we can find also the decorators for stretches and lanes: they
override basic operations by composition and enrich some of them with custom
behaviour. For example:

\begin{itemize}
  \item before entering a new lane it may be applied a given speed limit;
  \item before treading a stretch, further checks may be required if it is a
    part of a pedestrian/bicycle crossing.
 \end{itemize}
