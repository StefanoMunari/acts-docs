\subsection{Broker}

We decided to put an intermediate broker between the middleware(s) and the
application server(s) to make our system more scalable.

Indeed, the messages sent by the middleware have two deficiencies:

\begin{enumerate}
  \item \textbf{Size:} middleware messages carry a significant amount of
    information, because middleware does not perform deep inspection of the
    payload (the application domain is completely transparent) and, therefore,
    messages are forwarded as they are received from the upper application
    layer;
  \item \textbf{Poor semantics:} middleware outputs events with its best
    effort, but it can only read the headers of application layer messages.
    Therefore, message topics are just a concatenation of little detailed
    information obtained by the application.
\end{enumerate}

Our message broker tries to overcome these problems by performing deep
inspection on the payloads of the messages, filtering information from them and
building more meaningful topics for the messages (we will provide more details
in Section \ref{sec:impl-broker}).


\input{sections/solutionDesign/architecture/broker.tex}